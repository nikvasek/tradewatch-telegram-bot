# Configuration file for Excel merge operations
# Telegram Bot Token: 7402798055:AAGEgTHl5NFPyZ5QCUX7OIjDrNzENqSMGeI
# 
# Этот файл содержит все настройки для объединения Excel файлов по EAN кодам
# и форматирования результирующих файлов
# =============================================================================
# EXCEL ФОРМАТИРОВАНИЕ
# =============================================================================
# Настройки для форматирования результирующих Excel файлов

# Строка, с которой начинается запись данных в Excel (отсчет от 1)
EXCEL_TO_EXCEL_STARTROW = 3

# Номер строки для заголовков колонок (отсчет от 1)
EXCEL_HEADER_ROW_NUM = 4

# Номер строки, с которой начинаются данные (отсчет от 1)
EXCEL_DATA_START_ROW_NUM = 5

# Высота строки заголовков в пикселях
EXCEL_HEADER_ROW_HEIGHT = 65

# =============================================================================
# НАСТРОЙКИ ЗАГОЛОВКА
# =============================================================================
# Настройки для создания информационного заголовка в Excel файле
# Содержит курс валют, НДС, стоимость доставки и другие параметры
# Структура соответствует макету:
# - Колонка D: Названия параметров (Курс обмена, Доставка, Стоимость Prep Center)
# - Колонка G: Значения параметров (1,00; 0,00; 1,50)
# - Колонка I: Названия налогов и комиссий
# - Колонка M: Значения в процентах (0,00%; 1,00%; 0,00)

TITLE_ROWS = {
    # Первая строка заголовка: курс обмена, НДС поставщика
    1: {"D": "Курс обмена", "G": "1,00", "I": "Комиссия  Alegro (% от цены продажи)", "M": "0,00"},
    
    # Вторая строка: доставка, НДС Amazon
    2: {"D": "Доставка покупателю", "G": "0,00"},
    
    # Третья строка: стоимость Prep Center, комиссия PAN-EU
    3: {"D": "Упаковка", "G": "0"}
}

# =============================================================================
# ПОРЯДОК КОЛОНОК
# =============================================================================
# Определяет желаемый порядок колонок в результирующем файле
# Колонки будут расположены в указанном порядке, остальные добавятся в конце

DESIRED_COLUMN_ORDER = ['Lp', 'EAN', 'Price', 'Price PL', 'Cena min.', 'Profit', 'ROI', 'Link', 'Top oferta', 'Dost. szt.', 'Ilość aukcji', 'Transakcje (30 dni)', 'Product Link']

# =============================================================================
# ШАБЛОНЫ ФАЙЛОВ
# =============================================================================
# Настройки для поиска и фильтрации файлов

# Шаблон для поиска файлов TradeWatch (используется глоб-паттерн)
TRADEWATCH_FILE_PATTERN = "TradeWatch*.xlsx"

# Префиксы файлов, которые должны быть исключены из обработки
EXCLUDED_FILE_PREFIXES = ["TradeWatch", "~$", "merged_by_ean_result", "tradewatch_data_only", "merged_tradewatch_data"]

# =============================================================================
# НАЗВАНИЯ ЛИСТОВ
# =============================================================================
# Настройки для работы с листами Excel файлов

# Название листа в файлах TradeWatch, который содержит данные по EAN кодам
TRADEWATCH_SHEET_NAME = "Produkty wg EAN"

# =============================================================================
# СОПОСТАВЛЕНИЕ КОЛОНОК
# =============================================================================
# Настройки для поиска и сопоставления колонок в разных файлах

# Возможные названия колонок с GTIN/EAN кодами в каталогах товаров
POSSIBLE_GTIN_COLUMNS = ['GTIN', 'gtin', 'EAN', 'ean', 'GTIN-13', 'EAN-13']

# Колонки с ценами товаров (используется для расчета прибыли)
PRICE_COLUMNS = ['Price', 'Cena TOP oferty', 'Cena min.', 'Cena śred.']

# Колонки с себестоимостью товаров
COST_COLUMNS = ['Cost', 'Cena min.', 'Lowest Priced Offer Inventory']

# =============================================================================
# НАСТРОЙКИ ГИПЕРССЫЛОК
# =============================================================================
# Настройки для создания гиперссылок на Allegro

# Базовый URL для создания ссылок на предложения Allegro
ALLEGRO_BASE_URL = "https://allegro.pl/oferta/"

# Колонки, которые содержат номера для создания ссылок
# Приоритет отдается колонкам из блока минимальной цены (с суффиксом .1)
LINK_NUMBER_COLUMNS = ['Link.1', 'Link', 'Sprzedawca.1', 'Sprzedawca']

# =============================================================================
# ВЫХОДНЫЕ ФАЙЛЫ
# =============================================================================
# Названия файлов, которые создаются в результате обработки

# Основной результирующий файл с объединенными данными и расчетами
OUTPUT_FILE_WITH_CALCULATIONS = "merged_by_ean_result_with_calculations.xlsx"

# Файл только с данными TradeWatch (когда нет других файлов для объединения)
OUTPUT_FILE_TRADEWATCH_ONLY = "tradewatch_data_only_with_calculations.xlsx"

# Файл с объединенными данными нескольких TradeWatch файлов
OUTPUT_FILE_MERGED_TRADEWATCH = "tradewatch_data_with_calculations.xlsx"

# =============================================================================
# СТИЛИЗАЦИЯ EXCEL
# =============================================================================
# Настройки для оформления Excel файлов

# --- НАСТРОЙКИ ЗАГОЛОВКА С ДАННЫМИ ---
# Настройки шрифта для заголовка с данными (жирный, размер 10)
TITLE_FONT_SETTINGS = {'name': 'Arial', 'size': 10, 'bold': True}

# Цвет шрифта для названий данных в заголовке (бирюзовый)
TITLE_LABEL_FONT_COLOR = '008080'

# Цвет шрифта для значений данных в заголовке (коричневый)
TITLE_VALUE_FONT_COLOR = 'a52a2a'

# --- НАСТРОЙКИ ЗАГОЛОВКОВ ---
# Шрифт для заголовков таблицы (белый цвет)
HEADER_FONT = {'name': 'Arial', 'size': 11, 'bold': True, 'color': 'FFFFFF'}

# Выравнивание текста в заголовках
HEADER_ALIGNMENT = {'horizontal': 'center', 'vertical': 'center', 'wrap_text': True}

# Цвет фона заголовков (темно-синий)
HEADER_FILL = {'start_color': '057c95', 'end_color': '057c95', 'fill_type': 'solid'}

# --- НАСТРОЙКИ ДАННЫХ ---
# Шрифт для ячеек с данными
DATA_FONT = {'name': 'Arial', 'size': 10}

# Выравнивание текста в ячейках с данными по умолчанию
DATA_ALIGNMENT = {'horizontal': 'left', 'vertical': 'center'}

# Выравнивание текста в ячейках с данными по правому краю
DATA_ALIGNMENT_RIGHT = {'horizontal': 'right', 'vertical': 'center'}

# Колонки, которые должны быть выровнены по правому краю
RIGHT_ALIGNED_COLUMNS = ['Lp', 'EAN', 'Price', 'Price PL', 'Cena min.', 'Profit', 'ROI', 'Dost. szt.', 'Ilość aukcji', 'Transakcje (30 dni)']

# --- ФОРМАТЫ ЧИСЕЛ ---
# Формат чисел для колонок с ценами и прибылью (без ведущих нулей)
PRICE_NUMBER_FORMAT = '#,##0.00'

# Формат чисел для колонки ROI (в процентах с символом %)
ROI_NUMBER_FORMAT = '0%'

# Формат для колонки EAN (как текст, чтобы избежать научной нотации)
EAN_NUMBER_FORMAT = '@'

# Колонки, которые должны иметь формат цен (#,##0.00)
PRICE_FORMAT_COLUMNS = ['Price', 'Price PL', 'Cena min.', 'Profit']

# Колонки, которые должны иметь формат ROI (0%)
ROI_FORMAT_COLUMNS = ['ROI']

# Колонки, которые должны иметь текстовый формат (избегает научной нотации)
EAN_FORMAT_COLUMNS = ['EAN', 'GTIN', 'GTIN-13', 'EAN-13']

# --- ГРАНИЦЫ ТАБЛИЦЫ ---
# Стиль границ для заголовков таблицы (тонкая черная линия)
HEADER_BORDER_STYLE = {'border_style': 'thin', 'color': '000000'}

# Стиль границ для ячеек с данными (без границ)
DATA_BORDER_STYLE = None

# --- УСЛОВНОЕ ФОРМАТИРОВАНИЕ ---
# Настройки условного форматирования для колонок с данными
CONDITIONAL_FORMAT_PROFIT = {
    "start_value": 0, 
    "mid_value": 3, 
    "end_value": 7,
    "start_color": "FFFFFF",  # Белый
    "mid_color": "fff2cc",    # Светло-желтый
    "end_color": "93c47d"     # Зеленый
}

CONDITIONAL_FORMAT_ROI = {
    "start_value": 0, 
    "mid_value": 0.15, 
    "end_value": 0.35,
    "start_color": "FFFFFF",  # Белый
    "mid_color": "fff2cc",    # Светло-желтый  
    "end_color": "93c47d"     # Зеленый
}

# Колонки, которые должны иметь условное форматирование
CONDITIONAL_FORMAT_COLUMNS = {
    'Profit': CONDITIONAL_FORMAT_PROFIT,
    'ROI': CONDITIONAL_FORMAT_ROI
}

# =============================================================================
# ШИРИНА КОЛОНОК
# =============================================================================
# Настройки ширины колонок в Excel файле

# Ширина колонок по умолчанию (в символах)
DEFAULT_COLUMN_WIDTH = 12

# Настройки ширины для конкретных колонок
WIDE_COLUMNS = {
    'Lp': 6,         # Колонка для порядкового номера
    'Link': 8,        # Узкая колонка для текста "Link"
    'Top oferta': 35, # Широкая колонка для названий товаров
    'Product Link': 12,  # Колонка для ссылок на продукт
    'Transakcje (30 dni)': 15,  # Колонка для транзакций за 30 дней
    'Name': 30,       # Широкая колонка для названий товаров
    'Category': 20,   # Колонка для категорий
    'Brand': 15,      # Колонка для брендов
    'EAN': 18,        # Колонка для EAN кодов
    'GTIN': 15,       # Колонка для GTIN кодов
    'Price': 10,      # Колонка для цены
    'Price PL': 10,   # Колонка для цены в PLN
    'Cena min.': 10,  # Колонка для минимальной цены
    'Profit': 8,      # Колонка для прибыли
    'ROI': 8,         # Колонка для ROI (возврат инвестиций)
    'Dost. szt.': 10, # Колонка для доступного количества
    'Ilość aukcji': 12 # Колонка для количества аукционов
}
